<div class="container" *ngIf="problem">
  <div class="problem-header">
    <div class="title-section">
      <h1>{{ problem.title }}</h1>
      <span
        class="difficulty-badge"
        [ngClass]="problem.difficultyLevel.toLowerCase()"
      >
        {{ problem.difficultyLevel }}
      </span>
    </div>

    <div class="tags-section" *ngIf="problem.tags && problem.tags.length > 0">
      <span class="problem-tag" *ngFor="let tag of problem.tags">{{
        tag
      }}</span>
    </div>
  </div>

  <div class="problem-content">
    <div class="problem-description">
      <h2>Problem Description</h2>
      <p>{{ problem.description }}</p>

      <div *ngIf="problem.constraints" class="constraints">
        <h3>Constraints</h3>
        <p>{{ problem.constraints }}</p>
      </div>

      <div
        *ngIf="problem.examples && problem.examples.length > 0"
        class="examples"
      >
        <h3>Examples</h3>
        <div
          class="example"
          *ngFor="let example of problem.examples; let i = index"
        >
          <h4>Example {{ i + 1 }}</h4>
          <div class="example-content">
            <div class="example-input">
              <strong>Input:</strong>
              <pre>{{ example.input }}</pre>
            </div>
            <div class="example-output">
              <strong>Output:</strong>
              <pre>{{ example.output }}</pre>
            </div>
            <div class="example-explanation" *ngIf="example.explanation">
              <strong>Explanation:</strong>
              <p>{{ example.explanation }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="code-editor-section">
      <div class="editor-header">
        <h2>Solution</h2>
        <div class="editor-actions">
          <mat-form-field appearance="outline" class="language-selector">
            <mat-label>Programming Language</mat-label>
            <mat-select
              [(ngModel)]="selectedLanguage"
              (selectionChange)="onLanguageChange()"
            >
              <mat-option *ngFor="let lang of languages" [value]="lang.value">
                {{ lang.viewValue }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>

      <div class="editor-container">
        <app-code-editor
          [(code)]="code"
          [language]="selectedLanguage"
        ></app-code-editor>
      </div>

      <div class="submission-section">
        <button
          mat-raised-button
          class="run-button"
          (click)="runCode()"
          [disabled]="isRunning"
        >
          <mat-icon>play_arrow</mat-icon>
          Run
        </button>
        <button
          mat-raised-button
          class="submit-button"
          (click)="submitSolution()"
          [disabled]="isSubmitting"
        >
          <mat-icon>send</mat-icon>
          Submit Solution
        </button>
      </div>
    </div>
  </div>

  <div class="test-cases" *ngIf="result">
    <div class="test-case-header">
      <h3>Results</h3>
    </div>

    <div
      class="test-case-card"
      [ngClass]="{ success: result.success, error: !result.success }"
    >
      <div class="test-case-status">
        <mat-icon *ngIf="result.success" class="status-passed"
          >check_circle</mat-icon
        >
        <mat-icon *ngIf="!result.success" class="status-failed">error</mat-icon>
        <span>{{ result.success ? "Success" : "Failed" }}</span>
      </div>

      <div class="test-case-content">
        <div *ngIf="result.output" class="test-case-result">
          <strong>Output:</strong>
          <pre>{{ result.output }}</pre>
        </div>

        <div *ngIf="result.error" class="test-case-error">
          <strong>Error:</strong>
          <pre>{{ result.error }}</pre>
        </div>

        <div class="test-case-stats">
          <div
            *ngIf="result.executionTime !== undefined"
            class="test-case-stat"
          >
            <mat-icon>timer</mat-icon>
            <span>Execution Time: {{ result.executionTime }} ms</span>
          </div>
          <div *ngIf="result.memoryUsage !== undefined" class="test-case-stat">
            <mat-icon>memory</mat-icon>
            <span>Memory Usage: {{ result.memoryUsage }} MB</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="loading-overlay" *ngIf="isLoading">
  <mat-spinner class="loading-spinner"></mat-spinner>
</div>
